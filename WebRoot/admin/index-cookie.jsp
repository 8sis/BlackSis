<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%><%@ page import="tk.db.DBUnits"%><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><title>My JSP 'cookie.jsp' starting page</title><meta http-equiv="pragma" content="no-cache"><meta http-equiv="cache-control" content="no-cache"><meta http-equiv="expires" content="0"><meta http-equiv="keywords" content="keyword1,keyword2,keyword3"><meta http-equiv="description" content="This is my page"></head><body>	<%    	response.setContentType("text/html;charset=UTF-8");          //用户名和密码是否存在以及合法的判断参数          boolean bool=false;          //获取客户端Cookie数组         Cookie[] cookies = request.getCookies();          //判断客户端是否存在Cookie对象         if (cookies != null) {                   //预定义保存用户名和密码的变量                    String userpd = "";                    		String strsql = " select * from users  ";		DBUnits units = new DBUnits();		ArrayList list= units.getQuery1(strsql);		if (list.size()!=0){			Iterator it = list.iterator();		Map map = new HashMap();		map = (Map) it.next();		//遍历Cookie数组                 for (int i = 0; i < cookies.length; i++) {                             //取得每一个Cookie对象                            Cookie cookie = cookies[i];                           //判断Cookie的名称是否等于"accpLoginName"                            if ("userinfo".equals(cookie.getName()) && cookie.getValue()!="" ) {                                   userpd = cookie.getValue();                           }                                 }                    				                if(  userpd != ""){                 	 for(int i = 0; i < list.size();i++){                 	 							String  strpd =  (String) map.get("password"); 				 						if( strpd.equals(userpd)) {			//判断密码是否合法                           bool = true;                   		 	} 						}                 //判断对客户端的Cookie的操作是否成功，成功则显示登录成功后的页面，                  //否则，重定向到登录页面                  if(bool = true){                          response.sendRedirect("admin.jsp");                                       }     			    			      			}    			}    	}         %></body></html>